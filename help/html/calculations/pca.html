<html>
<!--
 * Jalview - A Sequence Alignment Editor and Viewer (Version 2.7)
 * Copyright (C) 2011 J Procter, AM Waterhouse, G Barton, M Clamp, S Searle
 * 
 * This file is part of Jalview.
 * 
 * Jalview is free software: you can redistribute it and/or
 * modify it under the terms of the GNU General Public License 
 * as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
 * 
 * Jalview is distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty 
 * of MERCHANTABILITY or FITNESS FOR A PARTICULAR 
 * PURPOSE.  See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License along with Jalview.  If not, see <http://www.gnu.org/licenses/>.
-->
<head>
<title>Principal Component Analysis</title>
</head>
<body>
<p><strong>Principal Component Analysis</strong></p>
<p>This calculation creates a spatial representation of the
similarities within a selected group, or all of the sequences in an
alignment. After the calculation finishes, a 3D viewer displays the set
of sequences as points in 'similarity space', and similar sequences tend
to lie near each other in the space.</p>
<p>Note: The calculation is computationally expensive, and may fail
for very large sets of sequences - usually because the JVM has run out
of memory. A future release of Jalview will be able to avoid this by
executing the calculation via a web service.</p>
<p>Principal components analysis is a technique for examining the
structure of complex data sets. The components are a set of dimensions
formed from the measured values in the data set, and the principle
component is the one with the greatest magnitude, or length. The sets of
measurements that differ the most should lie at either end of this
principle axis, and the other axes correspond to less extreme patterns
of variation in the data set.</p>

<p>In this case, the components are generated by an eigenvector
decomposition of the matrix formed from the sum of BLOSUM scores at each
aligned position between each pair of sequences. The matrix is not
symmetric - elements in the upper diagonal give the sum of scores for
mutating in one direction, and the lower diagonal is the sum of scores
for mutating in the other. This is a refinement of the method described
in the paper by G. Casari, C. Sander and A. Valencia. Structural Biology
volume 2, no. 2, February 1995 (<a
	href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=pubmed&dopt=Abstract&list_uids=7749921">pubmed</a>)
and implemented at the SeqSpace server at the EBI.</p>

<p><strong>The PCA Viewer</strong></p>
<p>This is an interactive display of the sequences positioned within
the similarity space, as points in a rotateable 3D scatterplot. The
colour of each sequence point is the same as the sequence group colours,
white if no colour has been defined for the sequence, and green if the
sequence is part of a the currently selected group.</p>
<p>The 3d view can be rotated by dragging the mouse with the <strong>left
mouse button</strong> pressed. The view can also be zoomed in and out with the up
and down <strong>arrow keys</strong> (and the roll bar of the mouse if
present). Labels will be shown for each sequence if the entry in the
View menu is checked, and the plot background colour changed from the
View&#8594;Background Colour.. dialog box. The File menu allows the view
to be saved (<strong>File&#8594;Save</strong> submenu) as an EPS or PNG
image or printed, and the original alignment data and matrix resulting
from its PCA analysis to be retrieved. The coordinates for the whole PCA
space, or just the current view may also be exported as CSV files for
visualization in another program or further analysis.</p>
<p>A tool tip gives the sequence ID corresponding to a point in the
space, and clicking a point toggles the selection of the corresponding
sequence in the associated alignment window views. Rectangular region
based selection is also possible, by holding the 'S' key whilst
left-clicking and dragging the mouse over the display. By default,
points are only associated with the alignment view from which the PCA
was calculated, but this may be changed via the <strong>View&#8594;Associate
Nodes</strong> sub-menu.</p>
<p>Initially, the display shows the first three components of the
similarity space, but any eigenvector can be used by changing the
selected dimension for the x, y, or z axis through each ones menu
located below the 3d display.</p>
<p>
<p>
</body>
</html>
